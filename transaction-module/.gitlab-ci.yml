# =========================================================================
#  _____                               _   _               __  __           _       _      
# |_   _| __ __ _ _ __  ___  __ _  ___| |_(_) ___  _ __   |  \/  | ___   __| |_   _| | ___ 
#   | || '__/ _` | '_ \/ __|/ _` |/ __| __| |/ _ \| '_ \  | |\/| |/ _ \ / _` | | | | |/ _ \
#   | || | | (_| | | | \__ \ (_| | (__| |_| | (_) | | | | | |  | | (_) | (_| | |_| | |  __/
#   |_||_|  \__,_|_| |_|___/\__,_|\___|\__|_|\___/|_| |_| |_|  |_|\___/ \__,_|\__,_|_|\___|
# =========================================================================

.header: &header
  before_script:
    - |
      echo -e "\033[1;36mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\033[0m"
      echo -e "\033[1;36mâ•‘                                                                              â•‘\033[0m"
      echo -e "\033[1;36mâ•‘\033[1;33m  _____                               _   _               __  __           _       _       \033[1;36mâ•‘\033[0m"
      echo -e "\033[1;36mâ•‘\033[1;33m |_   _| __ __ _ _ __  ___  __ _  ___| |_(_) ___  _ __   |  \/  | ___   __| |_   _| | ___  \033[1;36mâ•‘\033[0m"
      echo -e "\033[1;36mâ•‘\033[1;33m   | || '__/ _\` | '_ \\/ __|/ _\` |/ __| __| |/ _ \\| '_ \\  | |\/| |/ _ \\ / _\` | | | | |/ _ \\ \033[1;36mâ•‘\033[0m"
      echo -e "\033[1;36mâ•‘\033[1;33m   | || | | (_| | | | \\__ \\ (_| | (__| |_| | (_) | | | | | |  | | (_) | (_| | |_| | |  __/ \033[1;36mâ•‘\033[0m"
      echo -e "\033[1;36mâ•‘\033[1;33m   |_||_|  \\__,_|_| |_|___/\\__,_|\\___|\\___|_|\\___/|_| |_| |_|  |_|\\___/ \\__,_|\\__,_|_|\\___| \033[1;36mâ•‘\033[0m"
      echo -e "\033[1;36mâ•‘                                                                              â•‘\033[0m"
      echo -e "\033[1;36mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\033[0m"
      echo -e "\033[1;37m                     ğŸš€ Pipeline iniciado em: $(date)                      \033[0m"
      echo -e "\033[1;37m                     ğŸ”§ Executando com Maven: $(./mvn-with-auth --version | head -n 1)      \033[0m"
      echo -e "\033[1;37m                     ğŸ” Ambiente: $(uname -a | cut -d ' ' -f 1-3)                      \033[0m"
      echo ""

.footer: &footer
  after_script:
    - |
      echo ""
      echo -e "\033[1;32mâœ… Job concluÃ­do em: $(date)\033[0m"
      echo -e "\033[1;32mâ±ï¸  Tempo de execuÃ§Ã£o: $CI_JOB_DURATION\033[0m"
      echo -e "\033[1;32mğŸ“Š Status: $CI_JOB_STATUS\033[0m"
      echo ""

variables:
  MAVEN_OPTS: "-Dmaven.repo.local=.m2/repository -Dorg.slf4j.simpleLogger.log.org.apache.maven.cli.transfer.Slf4jMavenTransferListener=WARN -Dorg.slf4j.simpleLogger.showDateTime=true -Djava.awt.headless=true"
  MAVEN_CLI_OPTS: "--batch-mode --errors --fail-at-end --show-version"

stages:
  - build
  - lint
  - test
  - coverage
  - deploy

image: maven:3-openjdk-17

# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
# â•‘  ____        _ _     _                                                    â•‘
# â•‘ | __ ) _   _(_) | __| |                                                   â•‘
# â•‘ |  _ \| | | | | |/ _` |                                                   â•‘
# â•‘ | |_) | |_| | | | (_| |                                                   â•‘
# â•‘ |____/ \__,_|_|_|\__,_|                                                   â•‘
# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
build-job:
  stage: build
  <<: *header
  <<: *footer
  script:
    - |
      echo -e "\033[1;34mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\033[0m"
      echo -e "\033[1;34mâ•‘                                                                           â•‘\033[0m"
      echo -e "\033[1;34mâ•‘\033[1;33m  ____        _ _     _                                                  \033[1;34mâ•‘\033[0m"
      echo -e "\033[1;34mâ•‘\033[1;33m | __ ) _   _(_) | __| |                                                 \033[1;34mâ•‘\033[0m"
      echo -e "\033[1;34mâ•‘\033[1;33m |  _ \| | | | | |/ _\` |                                                 \033[1;34mâ•‘\033[0m"
      echo -e "\033[1;34mâ•‘\033[1;33m | |_) | |_| | | | (_| |                                                 \033[1;34mâ•‘\033[0m"
      echo -e "\033[1;34mâ•‘\033[1;33m |____/ \__,_|_|_|\__,_|                                                 \033[1;34mâ•‘\033[0m"
      echo -e "\033[1;34mâ•‘                                                                           â•‘\033[0m"
      echo -e "\033[1;34mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\033[0m"
      echo ""
      echo -e "\033[1;37mğŸ“¦ Compilando e instalando o projeto...\033[0m"
      echo -e "\033[1;37mâš™ï¸  Comando: ././mvn-with-auth-with-auth clean install -U\033[0m"
      echo ""
    - ./mvn-with-auth clean install -U $MAVEN_CLI_OPTS
    - |
      echo ""
      echo -e "\033[1;32mâœ¨ Build concluÃ­do com sucesso! âœ¨\033[0m"

# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
# â•‘  _     _       _                                                          â•‘
# â•‘ | |   (_)_ __ | |_                                                        â•‘
# â•‘ | |   | | '_ \| __|                                                       â•‘
# â•‘ | |___| | | | | |_                                                        â•‘
# â•‘ |_____|_|_| |_|\__|                                                       â•‘
# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
lint-job:
  stage: lint
  <<: *header
  <<: *footer
  script:
    - |
      echo -e "\033[1;35mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\033[0m"
      echo -e "\033[1;35mâ•‘                                                                           â•‘\033[0m"
      echo -e "\033[1;35mâ•‘\033[1;33m  _     _       _                                                        \033[1;35mâ•‘\033[0m"
      echo -e "\033[1;35mâ•‘\033[1;33m | |   (_)_ __ | |_                                                      \033[1;35mâ•‘\033[0m"
      echo -e "\033[1;35mâ•‘\033[1;33m | |   | | '_ \| __|                                                     \033[1;35mâ•‘\033[0m"
      echo -e "\033[1;35mâ•‘\033[1;33m | |___| | | | | |_                                                      \033[1;35mâ•‘\033[0m"
      echo -e "\033[1;35mâ•‘\033[1;33m |_____|_|_| |_|\__|                                                     \033[1;35mâ•‘\033[0m"
      echo -e "\033[1;35mâ•‘                                                                           â•‘\033[0m"
      echo -e "\033[1;35mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\033[0m"
      echo ""
      echo -e "\033[1;37mğŸ” Verificando estilo de cÃ³digo...\033[0m"
      echo -e "\033[1;37mâš™ï¸  Comando: ./mvn-with-auth checkstyle:check\033[0m"
      echo ""
    - ./mvn-with-auth checkstyle:check $MAVEN_CLI_OPTS
    - |
      echo ""
      echo -e "\033[1;32mâœ¨ VerificaÃ§Ã£o de estilo concluÃ­da com sucesso! âœ¨\033[0m"

# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
# â•‘  _____         _                                                          â•‘
# â•‘ |_   _|__  ___| |_                                                        â•‘
# â•‘   | |/ _ \/ __| __|                                                       â•‘
# â•‘   | |  __/\__ \ |_                                                        â•‘
# â•‘   |_|\___||___/\__|                                                       â•‘
# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
test-job:
  stage: test
  <<: *header
  <<: *footer
  script:
    - |
      echo -e "\033[1;32mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\033[0m"
      echo -e "\033[1;32mâ•‘                                                                           â•‘\033[0m"
      echo -e "\033[1;32mâ•‘\033[1;33m  _____         _                                                        \033[1;32mâ•‘\033[0m"
      echo -e "\033[1;32mâ•‘\033[1;33m |_   _|__  ___| |_                                                      \033[1;32mâ•‘\033[0m"
      echo -e "\033[1;32mâ•‘\033[1;33m   | |/ _ \/ __| __|                                                     \033[1;32mâ•‘\033[0m"
      echo -e "\033[1;32mâ•‘\033[1;33m   | |  __/\__ \ |_                                                      \033[1;32mâ•‘\033[0m"
      echo -e "\033[1;32mâ•‘\033[1;33m   |_|\___||___/\__|                                                     \033[1;32mâ•‘\033[0m"
      echo -e "\033[1;32mâ•‘                                                                           â•‘\033[0m"
      echo -e "\033[1;32mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\033[0m"
      echo ""
      echo -e "\033[1;37mğŸ§ª Executando testes...\033[0m"
      echo -e "\033[1;37mâš™ï¸  Comando: ./mvn-with-auth test\033[0m"
      echo ""
    - ./mvn-with-auth test $MAVEN_CLI_OPTS
    - |
      echo ""
      echo -e "\033[1;32mâœ¨ Testes concluÃ­dos com sucesso! âœ¨\033[0m"

# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
# â•‘   ____                                                                    â•‘
# â•‘  / ___|_____   _____ _ __ __ _  __ _  ___                                 â•‘
# â•‘ | |   / _ \ \ / / _ \ '__/ _` |/ _` |/ _ \                                â•‘
# â•‘ | |__| (_) \ V /  __/ | | (_| | (_| |  __/                                â•‘
# â•‘  \____\___/ \_/ \___|_|  \__,_|\__, |\___|                                â•‘
# â•‘                                |___/                                       â•‘
# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
coverage-job:
  stage: coverage
  <<: *header
  <<: *footer
  script:
    - |
      echo -e "\033[1;36mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\033[0m"
      echo -e "\033[1;36mâ•‘                                                                           â•‘\033[0m"
      echo -e "\033[1;36mâ•‘\033[1;33m   ____                                                                  \033[1;36mâ•‘\033[0m"
      echo -e "\033[1;36mâ•‘\033[1;33m  / ___|_____   _____ _ __ __ _  __ _  ___                               \033[1;36mâ•‘\033[0m"
      echo -e "\033[1;36mâ•‘\033[1;33m | |   / _ \ \ / / _ \ '__/ _\` |/ _\` |/ _ \                              \033[1;36mâ•‘\033[0m"
      echo -e "\033[1;36mâ•‘\033[1;33m | |__| (_) \ V /  __/ | | (_| | (_| |  __/                              \033[1;36mâ•‘\033[0m"
      echo -e "\033[1;36mâ•‘\033[1;33m  \____\___/ \_/ \___|_|  \__,_|\__, |\___|                              \033[1;36mâ•‘\033[0m"
      echo -e "\033[1;36mâ•‘\033[1;33m                                |___/                                     \033[1;36mâ•‘\033[0m"
      echo -e "\033[1;36mâ•‘                                                                           â•‘\033[0m"
      echo -e "\033[1;36mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\033[0m"
      echo ""
      echo -e "\033[1;37mğŸ“Š Gerando relatÃ³rio de cobertura...\033[0m"
      echo -e "\033[1;37mâš™ï¸  Comando: ./mvn-with-auth jacoco:report\033[0m"
      echo ""
    - ./mvn-with-auth jacoco:report $MAVEN_CLI_OPTS
    - |
      echo ""
      echo -e "\033[1;32mâœ¨ RelatÃ³rio de cobertura gerado com sucesso! âœ¨\033[0m"
      echo -e "\033[1;37mğŸ“ DisponÃ­vel em: target/site/jacoco\033[0m"
  artifacts:
    paths:
      - target/site/jacoco
    expire_in: 1 week
    when: always

# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
# â•‘  ____             _                                                       â•‘
# â•‘ |  _ \  ___ _ __ | | ___  _   _                                           â•‘
# â•‘ | | | |/ _ \ '_ \| |/ _ \| | | |                                          â•‘
# â•‘ | |_| |  __/ |_) | | (_) | |_| |                                          â•‘
# â•‘ |____/ \___| .__/|_|\___/ \__, |                                          â•‘
# â•‘            |_|            |___/                                           â•‘
# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
deploy-job:
  stage: deploy
  <<: *header
  <<: *footer
  script:
    - |
      echo -e "\033[1;33mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\033[0m"
      echo -e "\033[1;33mâ•‘                                                                           â•‘\033[0m"
      echo -e "\033[1;33mâ•‘\033[1;37m  ____             _                                                     \033[1;33mâ•‘\033[0m"
      echo -e "\033[1;33mâ•‘\033[1;37m |  _ \  ___ _ __ | | ___  _   _                                         \033[1;33mâ•‘\033[0m"
      echo -e "\033[1;33mâ•‘\033[1;37m | | | |/ _ \ '_ \| |/ _ \| | | |                                        \033[1;33mâ•‘\033[0m"
      echo -e "\033[1;33mâ•‘\033[1;37m | |_| |  __/ |_) | | (_) | |_| |                                        \033[1;33mâ•‘\033[0m"
      echo -e "\033[1;33mâ•‘\033[1;37m |____/ \___| .__/|_|\___/ \__, |                                        \033[1;33mâ•‘\033[0m"
      echo -e "\033[1;33mâ•‘\033[1;37m             |_|            |___/                                         \033[1;33mâ•‘\033[0m"
      echo -e "\033[1;33mâ•‘                                                                           â•‘\033[0m"
      echo -e "\033[1;33mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\033[0m"
      echo ""
      echo -e "\033[1;37mğŸš€ Implantando o projeto...\033[0m"
      echo -e "\033[1;37mâš™ï¸  Comando: ./mvn-with-auth deploy --settings ci_settings.xml\033[0m"
      echo ""
    - './mvn-with-auth deploy --settings ci_settings.xml $MAVEN_CLI_OPTS'
    - |
      echo ""
      echo -e "\033[1;32mâœ¨ ImplantaÃ§Ã£o concluÃ­da com sucesso! âœ¨\033[0m"